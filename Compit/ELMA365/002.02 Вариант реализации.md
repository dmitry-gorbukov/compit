как подключить додкументооборот в  elma365 к СМДО в Беларусь. Инструкция и последовательность действий? Можешь предложить вариант реализации коннектора для СМДО?

-------------------------

  
Мы хотим подключить ELMA365 к СМДО (Система межведомственного электронного документооборота) в Беларуси.  
Поскольку готовая интеграция может отсутствовать, рассмотрим вариант разработки собственного коннектора.

Общая идея:

1.  Изучить API СМДО (предположительно, SOAP) и требования к документам (форматы, подписи).
    
2.  Разработать промежуточное приложение (шлюз), которое будет выступать мостом между ELMA365 (REST API) и СМДО (SOAP).
    
3.  Настроить в ELMA365 бизнес-процессы, которые будут через HTTP-запросы взаимодействовать с этим шлюзом.
    

Шаги:

I. Подготовка:

-   Получить доступ к тестовой среде СМДО (учетные данные, сертификаты ЭЦП, WSDL).
    
-   Изучить документацию СМДО: методы отправки/получения документов, форматы (EDM-формат), требования к подписи.
    

II. Разработка шлюза (коннектора):

Вариант архитектуры шлюза:  
- Приложение на C# (или другом языке), которое может:  
а) принимать запросы от ELMA365 по REST API;  
б) формировать SOAP-запросы к СМДО;  
в) подписывать запросы ЭЦП (с использованием сертификата, полученного от СМДО);  
г) получать ответы от СМДО и передавать их в ELMA365.

Примерный план:

1.  Создание REST API в шлюзе для приема команд от ELMA365.  
    Например, эндпоинт для отправки документа:  
    POST /api/smdosend  
    Тело: { "documentId": "123", "recipient": "УП 'Пример'", "fileBase64": "...", "fileName": "doc.pdf" }
    
2.  Реализация SOAP-клиента для СМДО.
    
    -   Добавить WSDL СМДО в проект и сгенерировать классы для SOAP-запросов.
        
    -   Настроить клиент с учетом требований аутентификации (возможно, с использованием сертификата).
        
3.  Реализация подписания запросов ЭЦП.
    
    -   Использовать библиотеки для работы с ЭЦП (например, CryptoAPI .NET) и сертификат, полученный для доступа к СМДО.
        
4.  Преобразование документа в требуемый СМДО формат (если необходимо).
    
    -   Например, конвертация в EDM-формат (если требуется) и упаковка в SOAP-конверт.
        
5.  Отправка документа в СМДО и обработка ответа.
    
    -   После отправки, получить от СМДО идентификатор документа и статус, затем передать их в ELMA365.
        
6.  Реализация механизма опроса входящих документов из СМДО.
    
    -   Можно сделать эндпоинт в шлюзе, который будет периодически (по таймеру) опрашивать СМДО на наличие входящих документов (через SOAP-метод getIncomingDocuments).
        
    -   Полученные документы шлюз будет передавать в ELMA365 через REST API ELMA.
        
7.  Настройка безопасности:
    
    -   Обеспечить безопасное хранение сертификатов и учетных данных для доступа к СМДО.
        
    -   Настроить аутентификацию между ELMA365 и шлюзом (например, по API-ключу).
        

III. Настройка в ELMA365:

Для исходящих документов:  
- Создать бизнес-процесс, который в определенной точке (например, после согласования) будет отправлять HTTP-запрос на шлюз (на эндпоинт /api/smdosend).

Для входящих документов:  
- Вариант 1: Настроить в шлюзе периодический опрос СМДО и при получении нового документа отправлять его в ELMA365 через вебхук.  
- Вариант 2: В ELMA365 создать процесс, который по таймеру будет опрашивать шлюз (например, /api/smdocheck), а шлюз, в свою очередь, будет опрашивать СМДО.

Пример настройки в ELMA365 для отправки:

text

1. Создаем тип сущности "Исходящий документ СМДО" с полями: ID документа, статус, получатель и т.д.
2. В бизнес-процессе, который ведет к отправке, добавляем элемент "HTTP-запрос".
3. Настраиваем HTTP-запрос:
    - URL: http://ваш-шлюз/api/smdosend
    - Метод: POST
    - Заголовки: Content-Type: application/json
    - Тело: 
      {
        "processId": "{{ID}}",
        "documentTitle": "{{НазваниеДокумента}}",
        "recipientCode": "{{КодПолучателя}}",
        "fileContent": "{{ФайлДокумента.Base64}}"
      }

4. Обрабатываем ответ от шлюза (успех/ошибка) и обновляем статус документа в ELMA.

IV. Тестирование и ввод в эксплуатацию:

-   Тестирование в тестовой среде СМДО.
    
-   Проверка всей цепочки: от отправки из ELMA до получения в СМДО и обратно.
    
-   Проверка подписи и форматов.
    
-   Переход на промышленную среду.
    

Важно: Эта задача требует привлечения разработчиков, знакомых с SOAP, ЭЦП и REST API.

Если нет возможности разрабатывать свой шлюз, можно поискать готовые коммерческие решения, но в результатах поиска было указано только одно решение от CMD-Soft, которое, однако, не специфично для СМДО. Поэтому, возможно, придется разрабатывать собственное решение.

Надеюсь, эта инструкция поможет вам в реализации интеграции.

-----------------------------------


<!--stackedit_data:
eyJoaXN0b3J5IjpbMTQzMDU2Njc5OV19
-->