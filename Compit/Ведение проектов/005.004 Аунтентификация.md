
Проблема с входом в Joplin Server. Давайте решим это.

## Решение проблемы аутентификации:

### 1. Проверим текущие логины в базе данных

```bash
# Подключимся к контейнеру PostgreSQL
docker exec -it joplin-postgres psql -U joplin -d joplin

# В psql выполним:
SELECT email, is_admin FROM users;
\q
```

### 2. Сбросим или создадим администратора через командную строку

```bash
# Зайдем в контейнер Joplin Server
docker exec -it joplin-server sh

# В контейнере выполним команду для создания администратора
npm run cli -- create-admin --email dmitry.gorbukov@gmail.com --password Re@nimaT0r4$

# Или альтернативная команда
node packages/server/dist/app.js create-admin --email dmitry.gorbukov@gmail.com --password Re@nimaT0r4$
```

### 3. Если команды выше не работают, используем прямой SQL

```bash
docker exec -it joplin-postgres psql -U joplin -d joplin
```

```sql
-- Проверим существующих пользователей
SELECT * FROM users;

-- Если пользователь существует, сбросим пароль
UPDATE users SET password = '$2b$10$xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' 
WHERE email = 'dmitry.gorbukov@gmail.com';

-- Или создадим нового пользователя (если нет существующего)
INSERT INTO users (email, password, is_admin, created_time, updated_time) 
VALUES ('dmitry.gorbukov@gmail.com', '$2b$10$xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx', 1, now(), now());
```

### 4. Альтернативное решение - пересоздать контейнер с правильными настройками

Обновите ваш `compose.yml`, убрав параметры администратора из переменных окружения:

```yaml
environment:
  APP_PORT: 22300
  APP_BASE_URL: http://joplin.localhost
  APP_DATABASE_CONFIG: /config/database.json
  DB_CLIENT: postgres
  POSTGRES_DATABASE: joplin
  POSTGRES_USER: joplin
  POSTGRES_PASSWORD: joplin123456
  POSTGRES_HOST: joplin-db
  POSTGRES_PORT: 5432
  DB_SSL: "false"
  COOKIE_SECURE: "false"
  CHECK_ORIGIN: "false"
  APP_PROXY: "true"
  ALLOW_ORIGIN: "http://joplin.localhost,http://localhost:22300"
  ALLOW_SIGNUPS: "true"
  # УБЕРИТЕ эти строки:
  # ADMIN_EMAIL: dmitry.gorbukov@gmail.com
  # ADMIN_PASSWORD: Re@nimaT0r4$
```

Затем пересоздайте:

```bash
cd /opt/docker-services/joplin
docker-compose down
docker-compose up -d

# Дождитесь полного запуска, затем создайте администратора
docker exec -it joplin-server sh
npm run cli -- create-admin --email dmitry.gorbukov@gmail.com --password Re@nimaT0r4$
```

### 5. Проверка после создания администратора

После успешного создания администратора попробуйте войти снова:
- **Email:** dmitry.gorbukov@gmail.com
- **Password:** Re@nimaT0r4$

**Рекомендую начать с пункта 2** - создания администратора через CLI команду внутри контейнера. Это самый надежный способ.

Какой вариант пробуете сначала?
<!--stackedit_data:
eyJoaXN0b3J5IjpbNzQ0NDcyMjAxXX0=
-->