Отличный вопрос! Настроим автозапуск контейнеров как systemd сервисы. Вот полная инструкция:

## 1. Создаем структуру каталогов

```bash
sudo mkdir -p /opt/docker-services/{wiki-js,openproject,joplin,traefik}
sudo chown -R $USER:$USER /opt/docker-services
```

## 2. Traefik systemd сервис

`/etc/systemd/system/traefik.service`:
```ini
[Unit]
Description=Traefik Reverse Proxy
Documentation=https://traefik.io
After=docker.service
Requires=docker.service

[Service]
Type=oneshot
RemainAfterExit=yes
WorkingDirectory=/opt/docker-services/traefik
ExecStart=/usr/bin/docker compose up -d
ExecStop=/usr/bin/docker compose down
ExecReload=/usr/bin/docker compose restart
TimeoutStartSec=0

[Install]
WantedBy=multi-user.target
```

`/opt/docker-services/traefik/docker-compose.yml`:
```yaml
version: '3.8'

services:
  traefik:
    image: traefik:v2.10
    container_name: traefik
    restart: unless-stopped
    command:
      - --api.dashboard=true
      - --api.insecure=true
      - --providers.docker=true
      - --providers.docker.exposedbydefault=false
      - --entrypoints.web.address=:80
    ports:
      - "80:80"
      - "8080:8080"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    networks:
      - web

networks:
  web:
    external: true
```

## 3. Wiki.js systemd сервис

`/etc/systemd/system/wiki-js.service`:
```ini
[Unit]
Description=Wiki.js Service
After=docker.service traefik.service
Requires=docker.service
Wants=traefik.service

[Service]
Type=oneshot
RemainAfterExit=yes
WorkingDirectory=/opt/docker-services/wiki-js
ExecStart=/usr/bin/docker compose up -d
ExecStop=/usr/bin/docker compose down
ExecReload=/usr/bin/docker compose restart
TimeoutStartSec=0

[Install]
WantedBy=multi-user.target
```

`/opt/docker-services/wiki-js/docker-compose.yml`:
```yaml
version: '3.8'

services:
  wiki:
    image: ghcr.io/requarks/wiki:2
    container_name: wiki-js
    restart: unless-stopped
    environment:
      DB_TYPE: postgres
      DB_HOST: postgres
      DB_PORT: 5432
      DB_USER: wikijs
      DB_PASS: wikijsrocks
      DB_NAME: wiki
    volumes:
      - ./data:/var/wiki/data
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.wiki.rule=Host(`wiki.localhost`)"
      - "traefik.http.routers.wiki.entrypoints=web"
    depends_on:
      - postgres
    networks:
      - web
      - internal

  postgres:
    image: postgres:15
    container_name: wiki-postgres
    restart: unless-stopped
    environment:
      POSTGRES_DB: wiki
      POSTGRES_USER: wikijs
      POSTGRES_PASSWORD: wikijsrocks
    volumes:
      - ./db:/var/lib/postgresql/data
    networks:
      - internal

networks:
  web:
    external: true
  internal:
    external: false
```

## 4. OpenProject systemd сервис

`/etc/systemd/system/openproject.service`:
```ini
[Unit]
Description=OpenProject Service
After=docker.service traefik.service
Requires=docker.service
Wants=traefik.service

[Service]
Type=oneshot
RemainAfterExit=yes
WorkingDirectory=/opt/docker-services/openproject
ExecStart=/usr/bin/docker compose up -d
ExecStop=/usr/bin/docker compose down
ExecReload=/usr/bin/docker compose restart
TimeoutStartSec=0

[Install]
WantedBy=multi-user.target
```

`/opt/docker-services/openproject/docker-compose.yml`:
```yaml
version: '3.8'

services:
  openproject:
    image: openproject/community:12
    container_name: openproject
    restart: unless-stopped
    environment:
      OPENPROJECT_SECRET_KEY_BASE: secret
      OPENPROJECT_HOST__NAME: openproject.localhost
      OPENPROJECT_HTTPS: "false"
    volumes:
      - ./data:/var/openproject/assets
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.openproject.rule=Host(`openproject.localhost`)"
      - "traefik.http.routers.openproject.entrypoints=web"
    networks:
      - web
      - internal
    depends_on:
      - postgres

  postgres:
    image: postgres:13
    container_name: openproject-postgres
    restart: unless-stopped
    environment:
      POSTGRES_USER: openproject
      POSTGRES_PASSWORD: openproject
      POSTGRES_DB: openproject
    volumes:
      - ./db:/var/lib/postgresql/data
    networks:
      - internal

networks:
  web:
    external: true
  internal:
    external: false
```

## 5. Joplin systemd сервис

`/etc/systemd/system/joplin.service`:
```ini
[Unit]
Description=Joplin Server
After=docker.service traefik.service
Requires=docker.service
Wants=traefik.service

[Service]
Type=oneshot
RemainAfterExit=yes
WorkingDirectory=/opt/docker-services/joplin
ExecStart=/usr/bin/docker compose up -d
ExecStop=/usr/bin/docker compose down
ExecReload=/usr/bin/docker compose restart
TimeoutStartSec=0

[Install]
WantedBy=multi-user.target
```

`/opt/docker-services/joplin/docker-compose.yml`:
```yaml
version: '3.8'

services:
  joplin:
    image: joplin/server:latest
    container_name: joplin-server
    restart: unless-stopped
    environment:
      APP_BASE_URL: http://joplin.localhost
      DB_CLIENT: postgres
      POSTGRES_DATABASE: joplin
      POSTGRES_USER: joplin
      POSTGRES_PASSWORD: joplin
      POSTGRES_PORT: 5432
      POSTGRES_HOST: postgres
    volumes:
      - ./data:/var/lib/joplin
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.joplin.rule=Host(`joplin.localhost`)"
      - "traefik.http.routers.joplin.entrypoints=web"
    depends_on:
      - postgres
    networks:
      - web
      - internal

  postgres:
    image: postgres:13
    container_name: joplin-postgres
    restart: unless-stopped
    environment:
      POSTGRES_USER: joplin
      POSTGRES_PASSWORD: joplin
      POSTGRES_DB: joplin
    volumes:
      - ./db:/var/lib/postgresql/data
    networks:
      - internal

networks:
  web:
    external: true
  internal:
    external: false
```

## 6. Установка и настройка

### Создаем Docker сеть
```bash
docker network create web
```

### Копируем файлы
```bash
# Копируем systemd файлы
sudo cp *.service /etc/systemd/system/

# Копируем docker-compose файлы в соответствующие папки
cp docker-compose.yml /opt/docker-services/traefik/
cp docker-compose.yml /opt/docker-services/wiki-js/
cp docker-compose.yml /opt/docker-services/openproject/
cp docker-compose.yml /opt/docker-services/joplin/
```

### Инициализируем сервисы
```bash
# Перечитываем systemd конфигурацию
sudo systemctl daemon-reload

# Включаем автозапуск
sudo systemctl enable traefik.service wiki-js.service openproject.service joplin.service

# Запускаем сервисы
sudo systemctl start traefik.service
sudo systemctl start wiki-js.service
sudo systemctl start openproject.service
sudo systemctl start joplin.service
```

## 7. Управление сервисами

```bash
# Статус всех сервисов
sudo systemctl status traefik wiki-js openproject joplin

# Остановка сервиса
sudo systemctl stop wiki-js.service

# Запуск сервиса
sudo systemctl start wiki-js.service

# Перезапуск сервиса
sudo systemctl restart wiki-js.service

# Просмотр логов
sudo journalctl -u wiki-js.service -f

# Проверка автозапуска
sudo systemctl is-enabled wiki-js.service
```

## 8. Дополнительные скрипты для удобства

Создаем скрипт управления `/usr/local/bin/docker-services`:
```bash
sudo tee /usr/local/bin/docker-services > /dev/null << 'EOF'
#!/bin/bash

case "$1" in
    start)
        sudo systemctl start traefik.service wiki-js.service openproject.service joplin.service
        ;;
    stop)
        sudo systemctl stop traefik.service wiki-js.service openproject.service joplin.service
        ;;
    restart)
        sudo systemctl restart traefik.service wiki-js.service openproject.service joplin.service
        ;;
    status)
        sudo systemctl status traefik.service wiki-js.service openproject.service joplin.service
        ;;
    logs)
        sudo journalctl -u "$2".service -f
        ;;
    *)
        echo "Usage: $0 {start|stop|restart|status|logs [service-name]}"
        exit 1
        ;;
esac
EOF

sudo chmod +x /usr/local/bin/docker-services
```

## Использование скрипта:
```bash
# Запуск всех сервисов
docker-services start

# Остановка всех сервисов
docker-services stop

# Статус всех сервисов
docker-services status

# Логи конкретного сервиса
docker-services logs wiki-js
```

## Проверка работы

После настройки проверьте:
```bash
# Проверка сервисов
sudo systemctl status traefik wiki-js openproject joplin

# Проверка контейнеров
docker ps

# Проверка сетей
docker network ls
```

Теперь ваши контейнеры будут автоматически запускаться при загрузке системы и управляться через systemd!
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE1ODkwMjMwNjhdfQ==
-->